<view class="container">
  <view class="header">
    <text class="title">咖啡豆数据</text>
  </view>
  
  <!-- 过滤器 -->
  <view class="filter-container">
    <view class="filter-row">
      <picker class="filter-picker" bindchange="onCountryChange" range="{{countryRange}}">
        <view class="filter-label">国家: {{selectedCountryLabel || '全部'}} ({{countries.length}} 个国家)</view>
      </picker>
      
      <picker class="filter-picker" bindchange="onTypeChange" range="{{typeRange}}">
        <view class="filter-label">
          豆类: {{selectedTypeLabel || '全部'}}
        </view>
      </picker>
    </view>
  </view>
  
  <scroll-view class="table-scroll" scroll-x="true">
    <view class="table-container">
      <view class="table-header">
        <text class="table-cell name">名称</text>
        <text class="table-cell country">国家</text>
        <text class="table-cell origin">产地</text>
        <text class="table-cell grade">等级</text>
        <text class="table-cell type">类型</text>
        <text class="table-cell price">价格(元/kg)</text>
        <text class="table-cell status">状态</text>
      </view>
      
      <view wx:if="{{loading}}" class="loading">
        <text>加载中...</text>
      </view>
      
      <view wx:else>
        <view wx:for="{{coffeeBeans}}" wx:key="code" class="table-row" bindtap="onRowClick" data-item="{{item}}">
          <text class="table-cell name">{{item.name}}</text>
          <text class="table-cell country">{{item.country}}</text>
          <text class="table-cell origin">{{item.origin}}</text>
          <text class="table-cell grade">{{item.grade}}</text>
          <text class="table-cell type">{{item.type === 'premium' ? '精品' : '商业'}}</text>
          <text class="table-cell price">{{item.price_per_kg ? item.price_per_kg : '暂无'}}</text>
          <text class="table-cell status">{{item.sold_out ? '售罄' : '有货'}}</text>
        </view>
      </view>
    </view>
  </scroll-view>
  
  <!-- 分页控件 -->
  <view class="pagination" wx:if="{{!loading}}">
    <button class="page-btn" bindtap="onPrevPage" disabled="{{!pagination.has_prev}}">上一页</button>
    
    <view class="page-numbers">
      <block wx:for="{{[pagination.page-2, pagination.page-1, pagination.page, pagination.page+1, pagination.page+2]}}" wx:key="index">
        <block wx:if="{{item > 0 && item <= pagination.total_pages}}">
          <view 
            class="page-number {{item === pagination.page ? 'active' : ''}}" 
            bindtap="onPageChange" 
            data-page="{{item}}">
            {{item}}
          </view>
        </block>
      </block>
    </view>
    
    <button class="page-btn" bindtap="onNextPage" disabled="{{!pagination.has_next}}">下一页</button>
  </view>
  
  <!-- 详情弹窗 -->
  <view class="modal-mask" wx:if="{{showModal}}" bindtap="onCloseModal">
    <view class="modal-container" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">详细信息</text>
        <text class="close-btn" bindtap="onCloseModal">×</text>
      </view>
      <view class="modal-content" wx:if="{{selectedBean}}">
        <view class="detail-item">
          <text class="label">名称:</text>
          <text class="value">{{selectedBean.name}}</text>
        </view>
        <view class="detail-item">
          <text class="label">国家:</text>
          <text class="value">{{selectedBean.country}}</text>
        </view>
        <view class="detail-item">
          <text class="label">产地:</text>
          <text class="value">{{selectedBean.origin}}</text>
        </view>
        <view class="detail-item">
          <text class="label">等级:</text>
          <text class="value">{{selectedBean.grade}}</text>
        </view>
        <view class="detail-item">
          <text class="label">类型:</text>
          <text class="value">{{selectedBean.type === 'premium' ? '精品' : '商业'}}</text>
        </view>
        <view class="detail-item">
          <text class="label">价格:</text>
          <text class="value">{{selectedBean.price_per_kg ? selectedBean.price_per_kg + ' 元/kg' : '暂无'}}</text>
        </view>
        <view class="detail-item">
          <text class="label">状态:</text>
          <text class="value">{{selectedBean.sold_out ? '售罄' : '有货'}}</text>
        </view>
        <view class="detail-item">
          <text class="label">密度:</text>
          <text class="value">{{selectedBean.density}}</text>
        </view>
        <view class="detail-item">
          <text class="label">海拔:</text>
          <text class="value">{{selectedBean.altitude}}</text>
        </view>
        <view class="detail-item">
          <text class="label">风味:</text>
          <text class="value">{{selectedBean.flavor_profile}}</text>
        </view>
        <view class="detail-item">
          <text class="label">加工方式:</text>
          <text class="value">{{selectedBean.processing_method}}</text>
        </view>
        <view class="detail-item">
          <text class="label">品种:</text>
          <text class="value">{{selectedBean.variety}}</text>
        </view>
        <view class="detail-item">
          <text class="label">供应商:</text>
          <text class="value">{{selectedBean.provider}}</text>
        </view>
        <view class="detail-item">
          <text class="label">收获季节:</text>
          <text class="value">{{selectedBean.harvest_season}}</text>
        </view>
      </view>
    </view>
  </view>
</view>